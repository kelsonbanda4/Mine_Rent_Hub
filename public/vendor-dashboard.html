<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vendor Dashboard - MineRent Hub</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root {
      --primary: #1a3a5f;
      --secondary: #e9b44c;
      --accent: #9b2915;
      --dark: #1c1c1c;
      --light: #f5f5f5;
      --gray: #6c757d;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
      --sidebar-width: 250px;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f5f7fa;
      color: #333;
      display: flex;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    /* Sidebar Styles */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--primary);
      color: white;
      height: 100vh;
      position: fixed;
      top: 0;
      left: 0;
      padding: 20px 0;
      transition: all 0.3s ease;
      z-index: 1000;
      box-shadow: 3px 0 10px rgba(0,0,0,0.1);
    }
    
    .sidebar.open {
      left: 0;
    }
    
    .sidebar h2 {
      padding: 0 20px;
      margin-bottom: 30px;
      color: var(--secondary);
      font-size: 1.8rem;
      display: flex;
      align-items: center;
    }
    
    .sidebar h2 i {
      margin-right: 10px;
    }
    
    .sidebar a {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.3s;
      border-left: 4px solid transparent;
    }
    
    .sidebar a:hover, .sidebar a.active {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border-left: 4px solid var(--secondary);
    }
    
    .sidebar a i {
      margin-right: 10px;
      width: 24px;
      text-align: center;
    }
    
    .badge {
      background: var(--danger);
      color: white;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 0.8rem;
      margin-left: auto;
    }
    
    /* Main Content */
    .main {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 20px;
      transition: all 0.3s ease;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      margin-bottom: 25px;
      border-bottom: 1px solid #e0e0e0;
    }
    
    header h1 {
      color: var(--primary);
      font-size: 1.8rem;
    }
    
    .profile {
      display: flex;
      align-items: center;
      position: relative;
      cursor: pointer;
    }
    
    .profile img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 10px;
      border: 2px solid var(--secondary);
    }
    
    .dropdown {
      position: absolute;
      top: 50px;
      right: 0;
      background: white;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border-radius: 5px;
      width: 180px;
      z-index: 100;
      display: none;
      overflow: hidden;
    }
    
    .dropdown a {
      display: block;
      padding: 10px 15px;
      color: var(--dark);
      text-decoration: none;
      transition: all 0.3s;
    }
    
    .dropdown a:hover {
      background: #f5f7fa;
      color: var(--primary);
    }
    
    .dropdown.show {
      display: block;
    }
    
    /* Dashboard Cards */
    .summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      padding: 20px;
      display: flex;
      transition: transform 0.3s;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }
    
    .card i {
      font-size: 2.5rem;
      width: 70px;
      height: 70px;
      background: rgba(26, 58, 95, 0.1);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
      margin-right: 15px;
    }
    
    .card.earnings i {
      background: rgba(233, 180, 76, 0.1);
      color: var(--secondary);
    }
    
    .card.pending i {
      background: rgba(255, 193, 7, 0.1);
      color: var(--warning);
    }
    
    .card .info {
      flex: 1;
    }
    
    .card h3 {
      font-size: 1rem;
      color: var(--gray);
      margin-bottom: 5px;
    }
    
    .card p {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--dark);
    }
    
    /* Shortcuts */
    .shortcuts {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .shortcut-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 1px solid #eee;
    }
    
    .shortcut-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      border-color: var(--secondary);
    }
    
    .shortcut-card i {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 15px;
      background: rgba(26, 58, 95, 0.1);
      width: 70px;
      height: 70px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .shortcut-card h3 {
      font-size: 1.1rem;
      margin-bottom: 5px;
    }
    
    .shortcut-card p {
      color: var(--gray);
      font-size: 0.9rem;
    }
    
    /* Equipment Grid */
    .section {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.05);
      padding: 25px;
      margin-bottom: 30px;
    }
    
    .section h2 {
      color: var(--primary);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }
    
    .equipment-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }
    
    .equip-card {
      border: 1px solid #eee;
      border-radius: 10px;
      overflow: hidden;
      transition: all 0.3s;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    }
    
    .equip-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }
    
    .equip-img {
      height: 180px;
      overflow: hidden;
    }
    
    .equip-img img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s;
    }
    
    .equip-card:hover .equip-img img {
      transform: scale(1.05);
    }
    
    .equip-info {
      padding: 15px;
    }
    
    .equip-info h4 {
      font-size: 1.1rem;
      margin-bottom: 5px;
      color: var(--dark);
    }
    
    .equip-info p {
      color: var(--gray);
      margin-bottom: 10px;
      font-size: 0.9rem;
    }
    
    .equip-price {
      font-weight: 700;
      font-size: 1.2rem;
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .equip-actions {
      display: flex;
      justify-content: space-between;
    }
    
    .btn {
      padding: 8px 15px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
    }
    
    .btn i {
      margin-right: 5px;
    }
    
    .btn-edit {
      background: rgba(40, 167, 69, 0.1);
      color: var(--success);
    }
    
    .btn-delete {
      background: rgba(220, 53, 69, 0.1);
      color: var(--danger);
    }
    
    .btn-edit:hover {
      background: var(--success);
      color: white;
    }
    
    .btn-delete:hover {
      background: var(--danger);
      color: white;
    }
    
    /* Messages */
    .message-container {
      max-height: 500px;
      overflow-y: auto;
    }
    
    .message {
      padding: 15px;
      border-bottom: 1px solid #eee;
      display: flex;
      align-items: flex-start;
    }
    
    .message:last-child {
      border-bottom: none;
    }
    
    .message.unread {
      background: rgba(26, 58, 95, 0.05);
    }
    
    .message-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .message-content {
      flex: 1;
    }
    
    .message-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
    }
    
    .message-sender {
      font-weight: 600;
      color: var(--dark);
    }
    
    .message-time {
      color: var(--gray);
      font-size: 0.85rem;
    }
    
    .message-preview {
      color: var(--gray);
      font-size: 0.95rem;
    }
    
    /* Settings Section */
    .settings-tabs {
      display: flex;
      border-bottom: 1px solid #eee;
      margin-bottom: 20px;
    }
    
    .tab-button {
      padding: 10px 20px;
      background: none;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      color: var(--gray);
      cursor: pointer;
      position: relative;
      transition: all 0.3s;
    }
    
    .tab-button.active {
      color: var(--primary);
    }
    
    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background: var(--primary);
    }
    
    .tab-content {
      display: none;
      padding: 20px 0;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .settings-form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: var(--dark);
    }
    
    .form-group input, 
    .form-group select, 
    .form-group textarea {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }
    
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    .form-group.full-width {
      grid-column: span 2;
    }
    
    .profile-pic-container {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .profile-pic {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--secondary);
      margin-right: 20px;
    }
    
    .upload-btn-wrapper {
      position: relative;
      overflow: hidden;
      display: inline-block;
    }
    
    .btn-upload {
      background: var(--primary);
      color: white;
      padding: 8px 15px;
      border-radius: 5px;
      font-size: 0.9rem;
      cursor: pointer;
    }
    
    .upload-btn-wrapper input[type=file] {
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    
    /* Payment Methods */
    .payment-methods {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .payment-card {
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 15px;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      position: relative;
    }
    
    .payment-card.primary {
      border-color: var(--secondary);
      background: rgba(233, 180, 76, 0.05);
    }
    
    .payment-card .card-type {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .payment-card .card-type i {
      font-size: 1.5rem;
      margin-right: 10px;
      color: var(--primary);
    }
    
    .payment-card .card-number {
      font-size: 1.1rem;
      margin-bottom: 5px;
    }
    
    .payment-card .card-expiry {
      color: var(--gray);
      font-size: 0.9rem;
    }
    
    .payment-card .actions {
      position: absolute;
      top: 15px;
      right: 15px;
    }
    
    .payment-card .actions button {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--gray);
      font-size: 1rem;
      margin-left: 10px;
    }
    
    .payment-card .actions button:hover {
      color: var(--primary);
    }
    
    /* Modals */
    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      display: none;
    }
    
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      z-index: 1001;
      width: 90%;
      max-width: 600px;
      display: none;
    }
    
    .modal-header {
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #eee;
    }
    
    .modal-header h3 {
      color: var(--primary);
    }
    
    .modal-close {
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--gray);
      transition: color 0.3s;
    }
    
    .modal-close:hover {
      color: var(--dark);
    }
    
    .modal-body {
      padding: 20px;
    }
    
    form {
      display: grid;
      gap: 15px;
    }
    
    label {
      font-weight: 600;
      color: var(--dark);
      margin-bottom: 5px;
      display: block;
    }
    
    input, select, textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
    }
    
    textarea {
      min-height: 120px;
      resize: vertical;
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }
    
    .btn-submit {
      background: var(--primary);
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.3s;
      margin-top: 10px;
    }
    
    .btn-submit:hover {
      background: #152c47;
    }
    
    .btn-cancel {
      background: #f1f1f1;
      color: var(--dark);
      margin-right: 10px;
    }
    
    .btn-cancel:hover {
      background: #e5e5e5;
    }
    
    /* Logout Modal */
    #logoutModal .modal-body {
      text-align: center;
      padding: 30px 20px;
    }
    
    #logoutModal p {
      margin-bottom: 20px;
      font-size: 1.1rem;
    }
    
    .logout-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .btn-logout {
      background: var(--danger);
      color: white;
      padding: 10px 25px;
    }
    
    .btn-logout:hover {
      background: #bd2130;
    }
    
    .btn-cancel-logout {
      background: #f1f1f1;
      color: var(--dark);
    }
    
    /* Mobile Menu Toggle */
    .menu-toggle {
      position: fixed;
      top: 15px;
      left: 15px;
      background: var(--primary);
      color: white;
      border: none;
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1100;
      cursor: pointer;
      display: none;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    /* Responsive Styles */
    @media (max-width: 992px) {
      .sidebar {
        left: -250px;
      }
      
      .main {
        margin-left: 0;
      }
      
      .menu-toggle {
        display: flex;
      }
      
      .sidebar.open {
        left: 0;
      }
      
      .main.sidebar-open {
        margin-left: 0;
      }
      
      .settings-form {
        grid-template-columns: 1fr;
      }
      
      .form-group.full-width {
        grid-column: span 1;
      }
    }
    
    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .summary {
        grid-template-columns: 1fr;
      }
      
      .equipment-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 576px) {
      .modal {
        width: 95%;
      }
      
      .logout-buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <!-- Mobile Menu Toggle -->
  <button class="menu-toggle" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
  </button>
  
  <!-- Sidebar -->
  <aside class="sidebar">
    <h2><i class="fas fa-hard-hat"></i> MineRent</h2>
    <a href="#" class="active" onclick="navigate('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
    <a href="#" onclick="openUploadModal()"><i class="fas fa-upload"></i> Upload Equipment</a>
    <a href="#" onclick="navigate('myListings')"><i class="fas fa-list"></i> My Listings</a>
    <a href="#" onclick="navigate('messages')">
      <i class="fas fa-envelope"></i> Messages 
      <span class="badge" id="msgBadge">3</span>
    </a>
    <a href="#" onclick="navigate('bookings')"><i class="fas fa-calendar-check"></i> Bookings</a>
    <a href="#" onclick="navigate('settings')"><i class="fas fa-cog"></i> Settings</a>
    <a href="#" onclick="confirmLogout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
  </aside>

  <!-- Main Content -->
  <main class="main">
    <header>
      <div>
        <h1 id="pageTitle">Dashboard</h1>
      </div>
      <div class="profile" onclick="toggleDrop()">
        <img src="images/construction-site-3688252_1280.jpg" id="profilePic">
        <span id="vendorName">John Mining Co.</span>
        <div class="dropdown" id="profileDropdown">
          <a href="#" onclick="navigate('settings')"><i class="fas fa-user"></i> My Profile</a>
          <a href="#" onclick="navigate('settings')"><i class="fas fa-cog"></i> Settings</a>
          <a href="#" onclick="confirmLogout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
      </div>
    </header>

    <!-- Dashboard Section -->
    <section id="dashboard" class="section">
      <div class="summary">
        <div class="card">
          <i class="fas fa-database"></i>
          <div class="info">
            <h3>Uploaded Items</h3>
            <p id="uploadedCount">12</p>
          </div>
        </div>
        
        <div class="card pending">
          <i class="fas fa-calendar-check"></i>
          <div class="info">
            <h3>Pending Bookings</h3>
            <p id="pendingCount">5</p>
          </div>
        </div>
        
        <div class="card earnings">
          <i class="fas fa-wallet"></i>
          <div class="info">
            <h3>Total Earnings</h3>
            <p id="earnings">K28,500</p>
          </div>
        </div>
      </div>
      
      <h2>Quick Actions</h2>
      <div class="shortcuts">
        <div class="shortcut-card" onclick="openUploadModal()">
          <i class="fas fa-upload"></i>
          <h3>Upload</h3>
          <p>Add new equipment</p>
        </div>
        
        <div class="shortcut-card" onclick="navigate('myListings')">
          <i class="fas fa-list"></i>
          <h3>Listings</h3>
          <p>Manage your equipment</p>
        </div>
        
        <div class="shortcut-card" onclick="navigate('bookings')">
          <i class="fas fa-calendar-check"></i>
          <h3>Bookings</h3>
          <p>View all bookings</p>
        </div>
        
        <div class="shortcut-card" onclick="navigate('settings')">
          <i class="fas fa-cog"></i>
          <h3>Settings</h3>
          <p>Configure your account</p>
        </div>
      </div>
      
      <div class="section">
        <h2>Recent Bookings</h2>
        <div class="message-container">
          <div class="message unread">
            <div class="message-avatar">ZM</div>
            <div class="message-content">
              <div class="message-header">
                <div class="message-sender">Zambia Mining Ltd</div>
                <div class="message-time">Today, 10:30 AM</div>
              </div>
              <div class="message-preview">Requested Atlas Copco Drill Rig for 2 weeks</div>
            </div>
          </div>
          
          <div class="message">
            <div class="message-avatar">KG</div>
            <div class="message-content">
              <div class="message-header">
                <div class="message-sender">Kagem Mining</div>
                <div class="message-time">Yesterday, 3:45 PM</div>
              </div>
              <div class="message-preview">Inquiry about Sandvik DD422i development drill</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Listings Section -->
    <section id="myListings" class="section" style="display:none;">
      <div class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
        <h2>My Equipment Listings</h2>
        <button class="btn-submit" onclick="openUploadModal()">
          <i class="fas fa-plus"></i> Add New Equipment
        </button>
      </div>
      <div class="equipment-grid" id="equipmentGrid">
        <!-- Equipment items will be loaded here -->
      </div>
    </section>

    <!-- Messages Section -->
    <section id="messages" class="section" style="display:none;">
      <h2>Messages</h2>
      <div class="message-container" id="messageContainer">
        <!-- Messages will be loaded here -->
      </div>
    </section>
    
    <!-- Bookings Section -->
    <section id="bookings" class="section" style="display:none;">
      <h2>Equipment Bookings</h2>
      <div id="bookingsContainer">
        <!-- Bookings will be loaded here -->
      </div>
    </section>
    
    <!-- Settings Section -->
    <section id="settings" class="section" style="display:none;">
      <h2>Account Settings</h2>
      
      <div class="settings-tabs">
        <button class="tab-button active" data-tab="profile">Profile</button>
        <button class="tab-button" data-tab="account">Account</button>
        <button class="tab-button" data-tab="payments">Payments</button>
        <button class="tab-button" data-tab="notifications">Notifications</button>
      </div>
      
      <!-- Profile Settings Tab -->
      <div id="profile-tab" class="tab-content active">
        <div class="profile-pic-container">
          <img src="images/excavator-1174428_1280.jpg" class="profile-pic" id="settingsProfilePic">
          <div class="upload-btn-wrapper">
            <button class="btn-upload"><i class="fas fa-camera"></i> Change Photo</button>
            <input type="file" id="profilePhotoUpload" accept="image/*">
          </div>
        </div>
        
        <form class="settings-form" id="profileForm">
          <div class="form-group">
            <label for="companyName">Company Name</label>
            <input type="text" id="companyName" value="John Mining Co.">
          </div>
          
          <div class="form-group">
            <label for="contactPerson">Contact Person</label>
            <input type="text" id="contactPerson" value="Kelson Banda">
          </div>
          
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" id="email" value="kelsonbanda4@gmail.com">
          </div>
          
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" id="phone" value="+260 976 065 666">
          </div>
          
          <div class="form-group full-width">
            <label for="address">Business Address</label>
            <textarea id="address">123 Mining Avenue, Kitwe, Zambia</textarea>
          </div>
          
          <div class="form-group">
            <label for="businessType">Business Type</label>
            <select id="businessType">
              <option>Equipment Rental</option>
              <option>Mining Services</option>
              <option>Equipment Sales</option>
              <option>Equipment Manufacturing</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="yearsInBusiness">Years in Business</label>
            <input type="number" id="yearsInBusiness" value="8">
          </div>
          
          <div class="form-group full-width">
            <label for="about">About Your Business</label>
            <textarea id="about">We specialize in providing high-quality mining equipment for rental to small and medium-scale mining operations across Zambia. With over 8 years of experience, we ensure reliability and efficiency.</textarea>
          </div>
          
          <div class="form-group full-width" style="text-align: right; margin-top: 20px;">
            <button type="button" class="btn-cancel" onclick="discardChanges()">Discard Changes</button>
            <button type="submit" class="btn-submit">Save Profile</button>
          </div>
        </form>
      </div>
      
      <!-- Account Settings Tab -->
      <div id="account-tab" class="tab-content">
        <form class="settings-form" id="accountForm">
          <div class="form-group">
            <label for="currentPassword">Current Password</label>
            <input type="password" id="currentPassword">
          </div>
          
          <div class="form-group">
            <label for="newPassword">New Password</label>
            <input type="password" id="newPassword">
          </div>
          
          <div class="form-group">
            <label for="confirmPassword">Confirm New Password</label>
            <input type="password" id="confirmPassword">
          </div>
          
          <div class="form-group full-width">
            <label for="twoFactor">Two-Factor Authentication</label>
            <div style="display: flex; align-items: center;">
              <label class="switch">
                <input type="checkbox" id="twoFactor" checked>
                <span class="slider round"></span>
              </label>
              <span style="margin-left: 10px;">Enabled</span>
            </div>
          </div>
          
          <div class="form-group full-width" style="text-align: right; margin-top: 20px;">
            <button type="button" class="btn-cancel">Cancel</button>
            <button type="submit" class="btn-submit">Update Account</button>
          </div>
        </form>
      </div>
      
      <!-- Payment Settings Tab -->
      <div id="payments-tab" class="tab-content">
        <h3>Payment Methods</h3>
        <div class="payment-methods">
          <div class="payment-card primary">
            <div class="card-type">
              <i class="fab fa-cc-mastercard"></i>
              <div>
                <div class="card-number">•••• •••• •••• 1234</div>
                <div class="card-expiry">Expires 12/2025</div>
              </div>
            </div>
            <div class="actions">
              <button title="Set as primary"><i class="fas fa-star"></i></button>
              <button title="Remove"><i class="fas fa-trash"></i></button>
            </div>
          </div>
          
          <div class="payment-card">
            <div class="card-type">
              <i class="fab fa-cc-visa"></i>
              <div>
                <div class="card-number">•••• •••• •••• 5678</div>
                <div class="card-expiry">Expires 06/2024</div>
              </div>
            </div>
            <div class="actions">
              <button title="Set as primary"><i class="far fa-star"></i></button>
              <button title="Remove"><i class="fas fa-trash"></i></button>
            </div>
          </div>
        </div>
        
        <button class="btn-submit" style="margin-top: 20px;">
          <i class="fas fa-plus"></i> Add Payment Method
        </button>
        
        <div class="form-group" style="margin-top: 30px;">
          <label>Payout Preferences</label>
          <select>
            <option>Bank Transfer</option>
            <option>Mobile Money</option>
            <option>PayPal</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Payout Schedule</label>
          <select>
            <option>Daily</option>
            <option>Weekly</option>
            <option selected>Monthly</option>
          </select>
        </div>
        
        <div class="form-group full-width" style="text-align: right; margin-top: 20px;">
          <button type="button" class="btn-cancel">Cancel</button>
          <button type="button" class="btn-submit">Save Payment Settings</button>
        </div>
      </div>
      
      <!-- Notification Settings Tab -->
      <div id="notifications-tab" class="tab-content">
        <h3>Notification Preferences</h3>
        
        <div class="notification-setting">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <div>
              <h4>New Booking Requests</h4>
              <p>Get notified when someone requests to book your equipment</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="notification-setting">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <div>
              <h4>Booking Confirmations</h4>
              <p>Notifications when a booking is confirmed</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="notification-setting">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <div>
              <h4>Messages</h4>
              <p>Get notified when you receive new messages</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="notification-setting">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <div>
              <h4>Payment Updates</h4>
              <p>Notifications about payments and payouts</p>
            </div>
            <label class="switch">
              <input type="checkbox" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="notification-setting">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <div>
              <h4>Promotions & Offers</h4>
              <p>Receive special offers and platform updates</p>
            </div>
            <label class="switch">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="form-group" style="margin-top: 30px;">
          <label>Notification Method</label>
          <div>
            <label style="display: block; margin-bottom: 10px;">
              <input type="checkbox" checked> Email
            </label>
            <label style="display: block; margin-bottom: 10px;">
              <input type="checkbox" checked> SMS
            </label>
            <label style="display: block;">
              <input type="checkbox"> Push Notifications
            </label>
          </div>
        </div>
        
        <div class="form-group full-width" style="text-align: right; margin-top: 20px;">
          <button type="button" class="btn-cancel">Cancel</button>
          <button type="button" class="btn-submit">Save Notification Settings</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Upload Modal -->
  <div class="modal-backdrop" id="backdrop"></div>
  <div class="modal" id="uploadModal">
    <div class="modal-header">
      <h3>Upload Equipment</h3>
      <span class="modal-close" onclick="closeUploadModal()">×</span>
    </div>
    <div class="modal-body">
      <form id="uploadForm">
        <div class="form-row">
          <div>
            <label>Equipment Name:</label>
            <input type="text" name="name" placeholder="Atlas Copco Drill Rig" required>
          </div>
          <div>
            <label>Category:</label>
            <select name="type" required>
              <option value="">Select Category</option>
              <option>Drilling</option>
              <option>Crushing</option>
              <option>Excavation</option>
              <option>Screening</option>
              <option>Hauling</option>
              <option>Safety Gear</option>
            </select>
          </div>
        </div>
        
        <div class="form-row">
          <div>
            <label>Price (K/day):</label>
            <input type="number" name="price" placeholder="1500" required>
          </div>
          <div>
            <label>Image:</label>
            <input type="file" name="image" accept="image/*" required>
          </div>
        </div>
        
        <div>
          <label>Description:</label>
          <textarea name="description" placeholder="Detailed description of the equipment..." required></textarea>
        </div>
        
        <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
          <button type="button" class="btn-submit btn-cancel" onclick="closeUploadModal()">Cancel</button>
          <button type="submit" class="btn-submit">Upload Equipment</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Logout Modal -->
  <div class="modal-backdrop" id="logoutBackdrop"></div>
  <div class="modal" id="logoutModal">
    <div class="modal-header">
      <h3>Confirm Logout</h3>
      <span class="modal-close" onclick="cancelLogout()">×</span>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to log out of your account?</p>
      <div class="logout-buttons">
        <button class="btn-submit btn-logout" onclick="logout()">Yes, Logout</button>
        <button class="btn-submit btn-cancel-logout" onclick="cancelLogout()">Cancel</button>
      </div>
    </div>
  </div>

<script>
let user = null;
let equipment = [];

// 1. Fetch the logged-in user from localStorage
document.addEventListener('DOMContentLoaded', async function () {
  try {
    const userData = JSON.parse(localStorage.getItem('user'));
    if (!userData || !userData.id) {
      alert("User not logged in. Redirecting...");
      window.location.href = 'login.html';
      return;
    }

    const res = await fetch(`http://localhost:5000/api/vendor/me/${userData.id}`);
    if (!res.ok) throw new Error('Failed to fetch user');
    user = await res.json();

    document.getElementById('vendorName').innerText = user.name || 'Vendor';

    initSettings();
    loadDashboardStats();
    await loadListings();
    loadMessages();

  } catch (err) {
    console.error('User init failed:', err);
    alert("Unable to load user data.");
  }
});

// 2. Load equipment listings for logged-in vendor
async function loadListings() {
  try {
    const res = await fetch(`http://localhost:5000/api/vendor/my-equipment/${user.id}`);
    if (!res.ok) throw new Error('Failed to load listings');

    equipment = await res.json();
    const grid = document.getElementById('equipmentGrid');
    grid.innerHTML = '';

    equipment.forEach(item => {
      const card = document.createElement('div');
      card.className = 'equip-card';
      const statusBadge = item.availability === 'Rented'
        ? '<span style="background:#ffc107;color:white;padding:3px 8px;border-radius:4px;font-size:12px;position:absolute;top:10px;right:10px;">Rented</span>'
        : '';

      card.innerHTML = `
        <div class="equip-img" style="position:relative;">
          <img src="/uploads/${item.image}" alt="${item.name}">
          ${statusBadge}
        </div>
        <div class="equip-info">
          <h4>${item.name}</h4>
          <p><i class="fas fa-tag"></i> ${item.type}</p>
          <p class="equip-price">K${item.price}/day</p>
          <div class="equip-actions">
            <button class="btn btn-edit"><i class="fas fa-edit"></i> Edit</button>
            <button class="btn btn-delete"><i class="fas fa-trash"></i> Delete</button>
          </div>
        </div>
      `;
      grid.appendChild(card);
    });

  } catch (err) {
    console.error('Failed to load equipment:', err);
    alert('Could not load your listings.');
  }
}



// 3. Load vendor messages (replace with real fetch later)
function loadMessages() {
  const container = document.getElementById('messageContainer');
  container.innerHTML = '';

  const mockMessages = [
    {
      id: 1,
      sender: "Kagem Mining",
      time: "Today, 10:00 AM",
      content: "Is your Excavator available tomorrow?",
      read: false
    }
  ]; // Later: fetch from API `/api/vendor/messages/${user.id}`

  mockMessages.forEach(msg => {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${msg.read ? '' : 'unread'}`;
    const initials = msg.sender.split(" ").map(w => w[0]).join('');

    messageDiv.innerHTML = `
      <div class="message-avatar">${initials}</div>
      <div class="message-content">
        <div class="message-header">
          <div class="message-sender">${msg.sender}</div>
          <div class="message-time">${msg.time}</div>
        </div>
        <div class="message-preview">${msg.content}</div>
      </div>
    `;

    container.appendChild(messageDiv);
  });
}


 // Navigation functions
    function navigate(sec) {
      document.querySelectorAll('.section').forEach(el => el.style.display = 'none');
      document.getElementById(sec).style.display = 'block';
      document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
      
      // Set active link
      const links = document.querySelectorAll('.sidebar a');
      if (sec === 'dashboard') links[0].classList.add('active');
      else if (sec === 'myListings') links[1].classList.add('active');
      else if (sec === 'messages') links[3].classList.add('active');
      else if (sec === 'bookings') links[4].classList.add('active');
      else if (sec === 'settings') links[5].classList.add('active');
      
      document.getElementById('pageTitle').innerText = 
        sec === 'dashboard' ? 'Dashboard' : 
        sec === 'myListings' ? 'My Listings' : 
        sec === 'messages' ? 'Messages' : 
        sec === 'bookings' ? 'Bookings' : 
        sec === 'settings' ? 'Settings' : 'Dashboard';
    }
    
    function loadDashboardStats() {
      document.getElementById('uploadedCount').innerText = equipment.length;
      document.getElementById('pendingCount').innerText = '5';
      document.getElementById('earnings').innerText = 'K28,500';
    }
    
    function loadListings() {
      const grid = document.getElementById('equipmentGrid');
      grid.innerHTML = '';
      
      equipment.forEach(item => {
        const card = document.createElement('div');
        card.className = 'equip-card';
        
        // Determine status badge
        let statusBadge = '';
        if (item.availability === 'Rented') {
          statusBadge = '<span style="background:#ffc107;color:white;padding:3px 8px;border-radius:4px;font-size:12px;position:absolute;top:10px;right:10px;">Rented</span>';
        } else if (item.availability === 'Maintenance') {
          statusBadge = '<span style="background:#6c757d;color:white;padding:3px 8px;border-radius:4px;font-size:12px;position:absolute;top:10px;right:10px;">Maintenance</span>';
        }
        
        card.innerHTML = `
          <div class="equip-img" style="position:relative;">
            <img src="https://images.unsplash.com/photo-1581092580497-e0d23cbdf1dc?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="${item.name}">
            ${statusBadge}
          </div>
          <div class="equip-info">
            <h4>${item.name}</h4>
            <p><i class="fas fa-tag"></i> ${item.type}</p>
            <p class="equip-price">K${item.price}/day</p>
            <div class="equip-actions">
              <button class="btn btn-edit"><i class="fas fa-edit"></i> Edit</button>
              <button class="btn btn-delete"><i class="fas fa-trash"></i> Delete</button>
            </div>
          </div>
        `;
        
        grid.appendChild(card);
      });
    }
    
    function loadMessages() {
      const container = document.getElementById('messageContainer');
      container.innerHTML = '';
      
      messages.forEach(msg => {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${msg.read ? '' : 'unread'}`;
        
        // Get initials for avatar
        const initials = msg.sender.split(' ').map(n => n[0]).join('').substring(0, 2);
        
        messageDiv.innerHTML = `
          <div class="message-avatar">${initials}</div>
          <div class="message-content">
            <div class="message-header">
              <div class="message-sender">${msg.sender}</div>
              <div class="message-time">${msg.time}</div>
            </div>
            <div class="message-preview">${msg.content}</div>
          </div>
        `;
        
        container.appendChild(messageDiv);
      });
    }
    
    function openUploadModal() {
      document.getElementById('backdrop').style.display = 'block';
      document.getElementById('uploadModal').style.display = 'block';
    }
    
    function closeUploadModal() {
      document.getElementById('backdrop').style.display = 'none';
      document.getElementById('uploadModal').style.display = 'none';
    }
    
    function confirmLogout() {
      document.getElementById('logoutBackdrop').style.display = 'block';
      document.getElementById('logoutModal').style.display = 'block';
    }
    
    function cancelLogout() {
      document.getElementById('logoutBackdrop').style.display = 'none';
      document.getElementById('logoutModal').style.display = 'none';
    }
    
    function logout() {
      alert('You have been logged out successfully.');
      window.location.href = 'login.html';
    }
    
    function toggleDrop() {
      const dropdown = document.getElementById('profileDropdown');
      dropdown.classList.toggle('show');
    }
    
    function toggleSidebar() {
      document.querySelector('.sidebar').classList.toggle('open');
    }
    
    // Close dropdown when clicking outside
    window.onclick = function(event) {
      if (!event.target.matches('.profile') && !event.target.closest('.profile')) {
        const dropdown = document.getElementById('profileDropdown');
        if (dropdown.classList.contains('show')) {
          dropdown.classList.remove('show');
        }
      }
    }
    
    // Tab switching functionality
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', function() {
        // Remove active class from all buttons and contents
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        // Add active class to clicked button
        this.classList.add('active');
        
        // Show corresponding content
        const tabId = this.getAttribute('data-tab');
        document.getElementById(`${tabId}-tab`).classList.add('active');
      });
    });

// 4. Fill profile form with user data
function initSettings() {
  if (!user) return;
  document.getElementById('companyName').value = user.name || '';
  document.getElementById('email').value = user.email || '';
  document.getElementById('phone').value = user.phone || '';
  document.getElementById('address').value = user.address || '';
  document.getElementById('businessType').value = user.business_type || 'Equipment Rental';
  document.getElementById('yearsInBusiness').value = user.years_in_business || 1;
  document.getElementById('about').value = user.about || '';
  const pic = user.profile_pic || 'default.jpg';
  document.getElementById('settingsProfilePic').src = `/uploads/${pic}`;
  document.getElementById('profilePic').src = `/uploads/${pic}`;
}

// 5. Upload profile photo to server
document.getElementById('profilePhotoUpload').addEventListener('change', async function (e) {
  const file = e.target.files[0];
  if (!file) return;

  const formData = new FormData();
  formData.append('profile_pic', file);

  try {
    const response = await fetch(`http://localhost:5000/api/vendor/update-profile-pic/${user.id}`, {
      method: 'POST',
      body: formData
    });

    if (!response.ok) throw new Error('Upload failed');
    const data = await response.json();
    document.getElementById('settingsProfilePic').src = `/uploads/${data.filename}`;
    document.getElementById('profilePic').src = `/uploads/${data.filename}`;
    alert('Profile picture updated!');
  } catch (err) {
    console.error('Upload error:', err);
    alert('Failed to update profile picture.');
  }
});

// 6. Upload equipment form
document.getElementById('uploadForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  const form = document.getElementById('uploadForm');
  const formData = new FormData(form);
  formData.append('vendor_id', user.id);

  try {
    const res = await fetch('http://localhost:5000/upload-equipment', {
      method: 'POST',
      body: formData
    });

    if (!res.ok) {
      const err = await res.text();
      alert('Upload failed: ' + err);
      return;
    }

    alert('Equipment uploaded successfully!');
    form.reset();
    closeUploadModal();
    await loadListings();

  } catch (err) {
    alert('Upload failed: ' + err.message);
  }
});

// 7. Update dashboard stats
function loadDashboardStats() {
  document.getElementById('uploadedCount').innerText = equipment.length || 0;
  document.getElementById('pendingCount').innerText = '3'; // Later: fetch from bookings table
  document.getElementById('earnings').innerText = 'K0'; // Later: calculate actual vendor earnings


}


</script>


</body>
</html>